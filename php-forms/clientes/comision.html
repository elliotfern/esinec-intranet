<!DOCTYPE html>
<html>
<head>
  <title>Agregar Inputs con AJAX</title>
</head>
<body>

<form id="miFormulario">
  <div id="contenedorInputs">
    <!-- Los inputs adicionales se agregarán aquí -->
  </div>
  <input type="hidden" name="facturaId" value="12345">
  <button type="button" id="btnAgregarInput">Agregar Input</button>
  <button type="submit">Enviar</button>
</form>

<script>
var contador = 1;

document.getElementById('btnAgregarInput').addEventListener('click', function(event) {
  event.preventDefault();

  var contenedor = document.getElementById('contenedorInputs');

  var titulo = document.createElement('h3');
  titulo.textContent = 'Comisión ' + contador;
  contenedor.appendChild(titulo);

  var labelComision = document.createElement('label');
  labelComision.textContent = 'Comisión ' + contador + ': ';
  contenedor.appendChild(labelComision);

  var nuevoInput = document.createElement('input');
  nuevoInput.type = 'text';
  nuevoInput.name = 'comision' + contador;
  nuevoInput.id = 'comision' + contador;
  contenedor.appendChild(nuevoInput);

  var labelComisionista = document.createElement('label');
  labelComisionista.textContent = 'Comisionista ' + contador + ': ';
  contenedor.appendChild(labelComisionista);

  var nuevoInputComisionista = document.createElement('input');
  nuevoInputComisionista.type = 'text';
  nuevoInputComisionista.name = 'comisionista' + contador;
  nuevoInputComisionista.id = 'comisionista' + contador;
  contenedor.appendChild(nuevoInputComisionista);

  contador++;
});

document.getElementById('miFormulario').addEventListener('submit', function(event) {
  event.preventDefault();

  var inputs = document.querySelectorAll('#contenedorInputs input');
  var datos = {};

  inputs.forEach(function(input) {
    datos[input.id] = input.value;
  });

  // Envío de los datos al servidor utilizando AJAX
  fetch('guardar_datos.php', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(datos)
  })
  .then(function(response) {
    // Manejo de la respuesta del servidor
    if (response.ok) {
      console.log('Datos guardados correctamente.');
      // Realizar acciones adicionales si es necesario
    } else {
      console.log('Error al guardar los datos.');
    }
  })
  .catch(function(error) {
    console.log('Error en la solicitud AJAX:', error);
  });
});
</script>

</body>
</html>